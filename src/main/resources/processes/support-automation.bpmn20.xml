<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xmlns:flowable="http://flowable.org/bpmn"
             xsi:schemaLocation="
               http://www.omg.org/spec/BPMN/20100524/MODEL
               http://www.omg.org/spec/BPMN/20100524/BPMN20.xsd"
             targetNamespace="SupportAI">

    <process id="supportAutomation" isExecutable="true">

        <startEvent id="start"/>

        <serviceTask id="classifyTicket"
                     name="Classify Ticket"
                     flowable:delegateExpression="${classifyTicketDelegate}" />

        <exclusiveGateway id="decisionGateway"/>

        <serviceTask id="executeAction"
                     name="Execute Ticket Action"
                     flowable:delegateExpression="${ticketActionDelegate}" />

        <userTask id="humanReview" name="Human Review Required"/>

        <endEvent id="end"/>

        <sequenceFlow sourceRef="start" targetRef="classifyTicket"/>
        <sequenceFlow sourceRef="classifyTicket" targetRef="decisionGateway"/>

        <sequenceFlow sourceRef="decisionGateway" targetRef="humanReview">
            <conditionExpression xsi:type="tFormalExpression">
                <![CDATA[${requiresHumanReview == true}]]>
            </conditionExpression>
        </sequenceFlow>

        <sequenceFlow sourceRef="decisionGateway" targetRef="executeAction">
            <conditionExpression xsi:type="tFormalExpression">
                <![CDATA[${requiresHumanReview == false}]]>
            </conditionExpression>
        </sequenceFlow>

        <sequenceFlow sourceRef="executeAction" targetRef="end"/>
        <sequenceFlow sourceRef="humanReview" targetRef="end"/>

    </process>
</definitions>
